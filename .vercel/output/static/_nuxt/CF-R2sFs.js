import{_ as h}from"./DaRMw0Ry.js";import{e as k,n as _,f as N,u as P,c as a,a as e,g as s,b as f,w as v,l as C,d as i,m as c,v as b,t as y,k as S,F as A,r as q,o as n,j as x,p as V}from"./6JbxToWv.js";import{u as E}from"./Bhw1d7jc.js";import{u as O}from"./BRrJ57S3.js";const F={class:"container-custom py-8"},j={key:0,class:"text-center py-16"},B={class:"lg:col-span-2 space-y-6"},T={class:"bg-white rounded-lg shadow p-6"},U={class:"space-y-4"},D={class:"bg-white rounded-lg shadow p-6"},I={class:"bg-white rounded-lg shadow p-6"},L={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded"},M={class:"lg:col-span-1"},H={class:"bg-white rounded-lg shadow p-6 sticky top-24"},R={class:"space-y-3 mb-4 pb-4 border-b max-h-64 overflow-y-auto"},$={class:"w-16 h-16 bg-gray-200 rounded flex-shrink-0"},z=["src","alt"],J={class:"flex-grow min-w-0"},W={class:"font-semibold text-sm truncate"},Y={class:"text-primary-600 font-bold"},G={class:"space-y-3 mb-4 pb-4 border-b"},K={class:"flex justify-between"},Q={class:"font-semibold"},X={class:"flex justify-between text-lg font-bold mb-6"},Z={class:"text-primary-600"},ee=["disabled"],te={key:0},se={key:1},de=k({__name:"checkout",setup(oe){const d=E();_();const o=x({customerName:"",customerEmail:"",customerPhone:"",shippingAddress:"",customerNotes:""}),u=x(!1),m=x(""),g=r=>new Intl.NumberFormat("en-PH").format(r),w=async()=>{u.value=!0,m.value="";try{const{data:r,error:t}=await O("/api/orders",{method:"POST",body:{customerName:o.value.customerName,customerEmail:o.value.customerEmail,customerPhone:o.value.customerPhone,shippingAddress:o.value.shippingAddress,customerNotes:o.value.customerNotes,items:d.items.map(p=>({productId:p.productId,quantity:p.quantity}))}},"$Dqq9Ra5P7o");if(t.value){m.value=t.value.data?.message||"Failed to place order. Please try again.",u.value=!1;return}r.value&&r.value.success&&(d.clearCart(),await V(`/order-confirmation/${r.value.order.orderNumber}`))}catch(r){console.error("Order error:",r),m.value="An error occurred. Please try again.",u.value=!1}};return N(()=>{d.loadFromLocalStorage()}),P({title:"Checkout | Powell's Antique Shop"}),(r,t)=>{const p=h;return n(),a("div",F,[t[21]||(t[21]=e("h1",{class:"text-3xl font-serif font-bold mb-8"},"Checkout",-1)),s(d).items.length===0?(n(),a("div",j,[t[6]||(t[6]=e("p",{class:"text-gray-600 mb-4"},"Your cart is empty",-1)),f(p,{to:"/products",class:"btn btn-primary"},{default:v(()=>[...t[5]||(t[5]=[i(" Browse Products ",-1)])]),_:1})])):(n(),a("form",{key:1,onSubmit:C(w,["prevent"]),class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},[e("div",B,[e("div",T,[t[10]||(t[10]=e("h2",{class:"text-xl font-bold mb-4"},"Contact Information",-1)),e("div",U,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[i(" Full Name "),e("span",{class:"text-red-500"},"*")],-1)),c(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s(o).customerName=l),type:"text",required:"",class:"input",placeholder:"Juan Dela Cruz"},null,512),[[b,s(o).customerName]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[i(" Email Address "),e("span",{class:"text-red-500"},"*")],-1)),c(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>s(o).customerEmail=l),type:"email",required:"",class:"input",placeholder:"juan@example.com"},null,512),[[b,s(o).customerEmail]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[i(" Phone Number "),e("span",{class:"text-red-500"},"*")],-1)),c(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>s(o).customerPhone=l),type:"tel",required:"",class:"input",placeholder:"+63 912 345 6789"},null,512),[[b,s(o).customerPhone]])])])]),e("div",D,[t[12]||(t[12]=e("h2",{class:"text-xl font-bold mb-4"},"Shipping Address",-1)),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[i(" Complete Address "),e("span",{class:"text-red-500"},"*")],-1)),c(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=l=>s(o).shippingAddress=l),required:"",rows:"4",class:"input",placeholder:"Street address, Barangay, City, Province, Postal Code"},null,512),[[b,s(o).shippingAddress]])])]),e("div",I,[t[14]||(t[14]=e("h2",{class:"text-xl font-bold mb-4"},"Order Notes (Optional)",-1)),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Special instructions or delivery notes ",-1)),c(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=l=>s(o).customerNotes=l),rows:"3",class:"input",placeholder:"E.g., Call before delivery, Leave at gate, etc."},null,512),[[b,s(o).customerNotes]])])]),s(m)?(n(),a("div",L,y(s(m)),1)):S("",!0)]),e("div",M,[e("div",H,[t[19]||(t[19]=e("h2",{class:"text-xl font-bold mb-4"},"Order Summary",-1)),e("div",R,[(n(!0),a(A,null,q(s(d).items,l=>(n(),a("div",{key:l.id,class:"flex gap-3"},[e("div",$,[e("img",{src:l.image,alt:l.name,class:"w-full h-full object-cover"},null,8,z)]),e("div",J,[e("p",W,y(l.name),1),e("p",Y,"₱"+y(g(l.price)),1)])]))),128))]),e("div",G,[e("div",K,[t[15]||(t[15]=e("span",{class:"text-gray-600"},"Subtotal",-1)),e("span",Q,"₱"+y(g(s(d).subtotal)),1)]),t[16]||(t[16]=e("div",{class:"flex justify-between"},[e("span",{class:"text-gray-600"},"Shipping"),e("span",{class:"text-sm text-gray-500"},"To be arranged")],-1))]),e("div",X,[t[17]||(t[17]=e("span",null,"Total",-1)),e("span",Z,"₱"+y(g(s(d).total)),1)]),t[20]||(t[20]=e("div",{class:"bg-yellow-50 border border-yellow-200 rounded p-4 mb-4 text-sm"},[e("p",{class:"text-yellow-800"},[e("strong",null,"Payment:"),i(" We will contact you to arrange payment and shipping details after you place your order. ")])],-1)),e("button",{type:"submit",disabled:s(u),class:"btn btn-primary w-full py-3"},[s(u)?(n(),a("span",te,"Processing Order...")):(n(),a("span",se,"Place Order"))],8,ee),f(p,{to:"/cart",class:"btn btn-outline w-full py-3 mt-3 text-center block"},{default:v(()=>[...t[18]||(t[18]=[i(" Back to Cart ",-1)])]),_:1})])])],32))])}}});export{de as default};
