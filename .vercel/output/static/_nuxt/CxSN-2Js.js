import{_ as L}from"./DaRMw0Ry.js";import{e as S,x as q,n as R,B as D,f as T,z,w as x,_ as G,j as c,o as i,a as t,b as F,d as U,g as r,c as l,t as v,l as H,m as d,v as g,s as V,F as C,r as _,C as I,y as O,k as P,q as W}from"./6JbxToWv.js";const J={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},K={class:"mb-8"},Q={key:0,class:"text-center py-12"},X={key:1,class:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 text-red-700"},Y={class:"space-y-6"},Z={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},ee=["value"],te={class:"space-y-6"},se={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},oe={class:"sm:col-span-2"},re={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},ae={class:"flex items-center"},ie={class:"flex items-center"},le={class:"space-y-6"},de={class:"mb-4"},ne={class:"mt-1 text-xs text-gray-500"},me={key:0,class:"grid grid-cols-2 sm:grid-cols-3 gap-3"},ue=["src","alt"],pe={key:0,class:"absolute top-1 left-1 bg-primary-600 text-white text-xs px-2 py-1 rounded"},ce=["onClick"],ge={class:"mt-4"},ye={class:"mt-2"},fe={class:"flex justify-end space-x-3 pt-6 border-t border-gray-200"},be=["disabled"],xe={key:0},ve={key:1},Fe=S({__name:"[id]",setup(we){const A=q(),M=R(),w=A.params.id,k=c([]),b=c(!0),u=c(null),f=c(!1),a=c({name:"",description:"",price:0,categoryId:"",condition:"Excellent",material:"",history:"",images:[],isAvailable:!0,isFeatured:!1}),y=c("");D(y,s=>{a.value.images=s.split(`
`).map(e=>e.trim()).filter(e=>e.length>0)});const $=async()=>{try{b.value=!0,u.value=null;const s=await $fetch(`/api/admin/products/${w}`);a.value={name:s.name,description:s.description,price:Number(s.price),categoryId:s.categoryId,condition:s.condition||"Excellent",material:s.material||"",history:s.history||"",images:s.images||[],isAvailable:s.isAvailable!==void 0?s.isAvailable:!0,isFeatured:s.isFeatured||!1},y.value=s.images.join(`
`)}catch(s){u.value=s.message||"Failed to load product"}finally{b.value=!1}},B=async()=>{try{const s=await $fetch("/api/categories");k.value=s}catch(s){console.error("Failed to load categories:",s)}},j=async()=>{try{f.value=!0,u.value=null,await $fetch(`/api/admin/products/${w}`,{method:"PUT",body:a.value}),alert("Product updated successfully!"),M.push("/admin/products")}catch(s){u.value=s.data?.message||s.message||"Failed to update product"}finally{f.value=!1}},N=async s=>{const e=s.target,p=e.files;if(!(!p||p.length===0)){try{for(const n of Array.from(p)){if(!n.type.startsWith("image/")){alert(`${n.name} is not an image file`);continue}if(n.size>2*1024*1024){alert(`${n.name} is too large. Maximum size is 2MB.`);continue}const o=new FileReader;o.onload=m=>{const h=m.target?.result;a.value.images.push(h)},o.readAsDataURL(n)}}catch(n){console.error("Error uploading images:",n),alert("Failed to upload images")}e.value=""}},E=s=>{a.value.images.splice(s,1)};return T(()=>{$(),B()}),(s,e)=>{const p=L,n=G;return i(),z(n,{name:"admin"},{default:x(()=>[t("div",J,[t("div",K,[F(p,{to:"/admin/products",class:"text-sm text-primary-600 hover:text-primary-700 mb-4 inline-block"},{default:x(()=>[...e[10]||(e[10]=[U(" â† Back to Products ",-1)])]),_:1}),e[11]||(e[11]=t("h1",{class:"text-3xl font-bold text-gray-900"},"Edit Product",-1)),e[12]||(e[12]=t("p",{class:"mt-2 text-sm text-gray-700"},"Update product information",-1))]),r(b)?(i(),l("div",Q,[...e[13]||(e[13]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-gray-200 border-t-primary-600"},null,-1),t("p",{class:"mt-4 text-gray-600"},"Loading product...",-1)])])):r(u)?(i(),l("div",X,v(r(u)),1)):(i(),l("form",{key:2,onSubmit:H(j,["prevent"]),class:"space-y-8 bg-white shadow sm:rounded-lg p-6"},[t("div",Y,[e[21]||(e[21]=t("h2",{class:"text-lg font-medium text-gray-900"},"Basic Information",-1)),t("div",null,[e[14]||(e[14]=t("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Product Name *",-1)),d(t("input",{id:"name","onUpdate:modelValue":e[0]||(e[0]=o=>r(a).name=o),type:"text",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[g,r(a).name]])]),t("div",null,[e[15]||(e[15]=t("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"Description *",-1)),d(t("textarea",{id:"description","onUpdate:modelValue":e[1]||(e[1]=o=>r(a).description=o),rows:"4",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[g,r(a).description]])]),t("div",Z,[t("div",null,[e[16]||(e[16]=t("label",{for:"price",class:"block text-sm font-medium text-gray-700"},"Price ($) *",-1)),d(t("input",{id:"price","onUpdate:modelValue":e[2]||(e[2]=o=>r(a).price=o),type:"number",step:"0.01",min:"0",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[g,r(a).price,void 0,{number:!0}]])]),t("div",null,[e[18]||(e[18]=t("label",{for:"condition",class:"block text-sm font-medium text-gray-700"},"Condition *",-1)),d(t("select",{id:"condition","onUpdate:modelValue":e[3]||(e[3]=o=>r(a).condition=o),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[...e[17]||(e[17]=[t("option",{value:"Excellent"},"Excellent",-1),t("option",{value:"Very Good"},"Very Good",-1),t("option",{value:"Good"},"Good",-1),t("option",{value:"Fair"},"Fair",-1)])],512),[[V,r(a).condition]])])]),t("div",null,[e[20]||(e[20]=t("label",{for:"categoryId",class:"block text-sm font-medium text-gray-700"},"Category *",-1)),d(t("select",{id:"categoryId","onUpdate:modelValue":e[4]||(e[4]=o=>r(a).categoryId=o),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[e[19]||(e[19]=t("option",{value:""},"Select a category",-1)),(i(!0),l(C,null,_(r(k),o=>(i(),l("option",{key:o.id,value:o.id},v(o.name),9,ee))),128))],512),[[V,r(a).categoryId]])])]),t("div",te,[e[26]||(e[26]=t("h2",{class:"text-lg font-medium text-gray-900"},"Product Details",-1)),t("div",se,[t("div",null,[e[22]||(e[22]=t("label",{for:"material",class:"block text-sm font-medium text-gray-700"},"Material",-1)),d(t("input",{id:"material","onUpdate:modelValue":e[5]||(e[5]=o=>r(a).material=o),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[g,r(a).material]])]),t("div",oe,[e[23]||(e[23]=t("label",{for:"history",class:"block text-sm font-medium text-gray-700"},"History / Provenance",-1)),d(t("textarea",{id:"history","onUpdate:modelValue":e[6]||(e[6]=o=>r(a).history=o),rows:"3",placeholder:"Historical information about this item...",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[g,r(a).history]])])]),t("div",re,[t("div",ae,[d(t("input",{id:"isAvailable","onUpdate:modelValue":e[7]||(e[7]=o=>r(a).isAvailable=o),type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"},null,512),[[I,r(a).isAvailable]]),e[24]||(e[24]=t("label",{for:"isAvailable",class:"ml-2 block text-sm text-gray-900"}," Available for Purchase ",-1))]),t("div",ie,[d(t("input",{id:"isFeatured","onUpdate:modelValue":e[8]||(e[8]=o=>r(a).isFeatured=o),type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"},null,512),[[I,r(a).isFeatured]]),e[25]||(e[25]=t("label",{for:"isFeatured",class:"ml-2 block text-sm text-gray-900"}," Featured Product ",-1))])])]),t("div",le,[e[29]||(e[29]=t("h2",{class:"text-lg font-medium text-gray-900"},"Images",-1)),e[30]||(e[30]=t("p",{class:"text-sm text-gray-500 mb-3"},"Upload product images. The first image will be the main product image.",-1)),t("div",de,[t("input",{type:"file",accept:"image/*",multiple:"",onChange:N,class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100 cursor-pointer"},null,32),t("p",ne,v(r(a).images.length)+" image(s) added",1)]),r(a).images.length>0?(i(),l("div",me,[(i(!0),l(C,null,_(r(a).images,(o,m)=>(i(),l("div",{key:m,class:"relative group"},[t("img",{src:o,alt:`Product image ${m+1}`,class:O(["w-full h-32 object-cover rounded-lg border-2",m===0?"border-primary-500":"border-gray-200"])},null,10,ue),m===0?(i(),l("div",pe," Main ")):P("",!0),t("button",{type:"button",onClick:h=>E(m),class:"absolute top-1 right-1 bg-red-600 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity"},[...e[27]||(e[27]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,ce)]))),128))])):P("",!0),t("details",ge,[e[28]||(e[28]=t("summary",{class:"text-sm text-gray-600 cursor-pointer hover:text-primary-600"},"Or add image URLs manually",-1)),t("div",ye,[d(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=o=>W(y)?y.value=o:null),rows:"4",placeholder:`https://example.com/image1.jpg
https://example.com/image2.jpg`,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm font-mono text-xs"},null,512),[[g,r(y)]])])])]),t("div",fe,[F(p,{to:"/admin/products",class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},{default:x(()=>[...e[31]||(e[31]=[U(" Cancel ",-1)])]),_:1}),t("button",{type:"submit",disabled:r(f),class:"inline-flex justify-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"},[r(f)?(i(),l("span",xe,"Saving...")):(i(),l("span",ve,"Save Changes"))],8,be)])],32))])]),_:1})}}});export{Fe as default};
