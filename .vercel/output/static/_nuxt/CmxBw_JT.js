import{e as N,f as S,z as D,w as F,_ as B,j as n,o as r,a as t,g as s,c as i,t as l,F as L,r as P,k as x,y as T,l as h,m as _,v as w}from"./6JbxToWv.js";const V={class:"sm:flex sm:items-center sm:justify-between mb-6"},j={class:"mt-4 sm:mt-0"},z={key:0,class:"text-center py-12"},A={key:1,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded"},U={key:2,class:"bg-white shadow-md rounded-lg overflow-hidden"},q={class:"min-w-full divide-y divide-gray-200"},O={class:"bg-white divide-y divide-gray-200"},G={class:"px-6 py-4 whitespace-nowrap"},H={class:"text-sm font-medium text-gray-900"},I={key:0,class:"text-sm text-gray-500"},J={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},K={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Q={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2"},R=["onClick"],W=["onClick","disabled"],X={key:0},Y={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},Z={class:"mt-3"},tt={class:"text-lg font-medium leading-6 text-gray-900 mb-4"},et={key:0,class:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded"},st={class:"flex justify-end space-x-3 pt-4"},at=["disabled"],it=N({__name:"index",setup(ot){const y=n([]),g=n(!0),m=n(null),f=n(!1),c=n(null),p=n(!1),u=n(null),d=n({name:"",description:""}),v=async()=>{try{g.value=!0,m.value=null;const a=await $fetch("/api/admin/categories");y.value=a}catch(a){m.value=a.data?.message||"Failed to load categories"}finally{g.value=!1}},k=a=>{c.value=a,d.value={name:a.name,description:a.description||""}},C=async()=>{try{p.value=!0,u.value=null,c.value?await $fetch(`/api/admin/categories/${c.value.id}`,{method:"PUT",body:d.value}):await $fetch("/api/admin/categories",{method:"POST",body:d.value}),b(),await v()}catch(a){u.value=a.data?.message||"Failed to save category"}finally{p.value=!1}},$=async a=>{if(a._count.products>0){alert(`Cannot delete category with ${a._count.products} product(s). Please reassign or delete the products first.`);return}if(confirm(`Are you sure you want to delete "${a.name}"?`))try{await $fetch(`/api/admin/categories/${a.id}`,{method:"DELETE"}),await v()}catch(e){alert(e.data?.message||"Failed to delete category")}},b=()=>{f.value=!1,c.value=null,u.value=null,d.value={name:"",description:""}};return S(()=>{v()}),(a,e)=>{const E=B;return r(),D(E,{name:"admin"},{default:F(()=>[t("div",null,[t("div",V,[e[3]||(e[3]=t("div",null,[t("h1",{class:"text-3xl font-serif font-bold text-gray-900"},"Categories"),t("p",{class:"mt-2 text-sm text-gray-700"},"Manage product categories")],-1)),t("div",j,[t("button",{onClick:e[0]||(e[0]=o=>f.value=!0),class:"btn btn-primary"}," Add Category ")])]),s(g)?(r(),i("div",z,[...e[4]||(e[4]=[t("p",{class:"text-gray-500"},"Loading categories...",-1)])])):s(m)?(r(),i("div",A,l(s(m)),1)):(r(),i("div",U,[t("table",q,[e[6]||(e[6]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Name "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Slug "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Products "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),t("tbody",O,[(r(!0),i(L,null,P(s(y),o=>(r(),i("tr",{key:o.id},[t("td",G,[t("div",H,l(o.name),1),o.description?(r(),i("div",I,l(o.description),1)):x("",!0)]),t("td",J,l(o.slug),1),t("td",K,l(o._count.products)+" product(s) ",1),t("td",Q,[t("button",{onClick:M=>k(o),class:"text-primary-600 hover:text-primary-900"}," Edit ",8,R),t("button",{onClick:M=>$(o),class:T(["text-red-600 hover:text-red-900",{"opacity-50 cursor-not-allowed":o._count.products>0}]),disabled:o._count.products>0}," Delete ",10,W)])]))),128)),s(y).length===0?(r(),i("tr",X,[...e[5]||(e[5]=[t("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500"}," No categories found. Create your first category to get started. ",-1)])])):x("",!0)])])]))]),s(f)||s(c)?(r(),i("div",{key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:h(b,["self"])},[t("div",Y,[t("div",Z,[t("h3",tt,l(s(c)?"Edit Category":"Create Category"),1),s(u)?(r(),i("div",et,l(s(u)),1)):x("",!0),t("form",{onSubmit:h(C,["prevent"]),class:"space-y-4"},[t("div",null,[e[7]||(e[7]=t("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Name *",-1)),_(t("input",{id:"name","onUpdate:modelValue":e[1]||(e[1]=o=>s(d).name=o),type:"text",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[w,s(d).name]])]),t("div",null,[e[8]||(e[8]=t("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"Description",-1)),_(t("textarea",{id:"description","onUpdate:modelValue":e[2]||(e[2]=o=>s(d).description=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[w,s(d).description]])]),t("div",st,[t("button",{type:"button",onClick:b,class:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),t("button",{type:"submit",disabled:s(p),class:"btn btn-primary"},l(s(p)?"Saving...":"Save"),9,at)])],32)])])])):x("",!0)]),_:1})}}});export{it as default};
